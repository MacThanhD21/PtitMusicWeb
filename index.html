<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Slick JS -->
  <link rel="stylesheet" type="text/css" href="./assets/animation/slick/slick.css" />
  <link rel="stylesheet" type="text/css" href="./assets/animation/slick/slick-theme.css" />

  <!-- IMPORT FONT AWESOME -->
  <link rel="stylesheet" type="text/css" href="./assets/fonts/css/all.min.css" />
  <link rel="stylesheet" type="text/css" href="./assets/fonts/css/fontawesome.min.css" />
  <!-- IMPORT FAVICON -->
  <link rel="shortcut icon"
    href="https://firebasestorage.googleapis.com/v0/b/ptitmusic-57385.appspot.com/o/main_logo.png?alt=media&token=03cfebd8-8068-4fc8-8372-d9c1a3b0aeb5"
    type="image/png" />

  <!-- IMPORT CSS MAIN -->
  <link rel="stylesheet" href="./assets/css/reset.css" />
  <link rel="stylesheet" href="./assets/css/base.css" />
  <link rel="stylesheet" href="./assets/css/style.css" />

  <!-- TITLE -->
  <title>Ptit Music</title>
</head>

<body id="Top" class="switchMode">

  <!-- Section Navbar Toggle -->
  <section class="side-bar">
    <!-- Section-one -->
    <div class="section-one">
      <div class="logo-menu">
        <h2 class="logo">Menu</h2>
        <i class="fa-solid fa-angles-right toggle-btn-1"></i>
        <i class="fa-solid fa-angles-left toggle-btn-2"></i>
      </div>
      <!-- Menu -->
      <ul class="list">
        <li class="list-item active">
          <a href="#explore">
            <i class="fa-solid fa-rocket"></i>
            <span class="link-name" style="--i: 1">Explore</span>
          </a>
        </li>
        <li class="list-item">
          <a href="#featured_creators">
            <i class="fa-solid fa-music"></i>
            <span class="link-name" style="--i: 2">Featured Creators</span>
          </a>
        </li>
        <li class="list-item">
          <a href="#trending">
            <i class="fa-solid fa-arrow-trend-up"></i>
            <span class="link-name" style="--i: 3">Trending</span>
          </a>
        </li>
        <li class="list-item">
          <a href="#category">
            <i class="fa-solid fa-compact-disc"></i>
            <span class="link-name" style="--i: 4">Genre</span>
          </a>
        </li>
        <li class="list-item">
          <a href="#popular_artists">
            <i class="fa-solid fa-headset"></i>
            <span class="link-name" style="--i: 4">Popular Singer</span>
          </a>
        </li>
      </ul>
    </div>

    <!-- Section-two -->
    <div class="section-two">
      <!-- My music -->
      <div class="logo-menu">
        <h2 class="logo">My music</h2>
        <i class="fa-solid fa-headphones toggle-btn-1"></i>
      </div>
      <!-- Menu -->
      <ul class="list">
        <!-- <li class="list-item">
          <a href="#">
            <i class="fa-solid fa-clock-rotate-left"></i>
            <span class="link-name" style="--i: 5"> Recently Played </span>
          </a>
        </li>
        <li class="list-item">
          <a href="#">
            <i class="fa-solid fa-heart"></i>
            <span class="link-name" style="--i: 6"> Favorite Songs </span>
          </a>
        </li> -->
        <li class="list-item">
          <a href="genmusic.html">
            <i class="fa-solid fa-robot"></i>
            <span class="link-name" style="--i: 7"> Music GenAI </span>
          </a>
        </li>
      </ul>
    </div>
  </section>
  <!-- End Section Navbar Toggle -->

  <!-- Section Main -->

  <section class="main">
    <!-- NAVBAR -->
    <nav id="navbarFixed">
      <ul>
        <div class="inner-logo">
          <a href="index.html"><img
              src="https://firebasestorage.googleapis.com/v0/b/ptitmusic-57385.appspot.com/o/main_logo.png?alt=media&token=03cfebd8-8068-4fc8-8372-d9c1a3b0aeb5"
              alt="" title="ptit_music" />
          </a>
          <a href="index.html">
            <span class="name__website">Ptit Music</span>
          </a>
        </div>
      </ul>
      <!-- FORM: SEARCH -->
      <div id="search">
        <input type="search" placeholder="What do you want to play?" aria-placeholder="Search for music"
          autofocus="true" />
      </div>
      <ul>
        <a>
          <label class="switch">
            <input checked="javascript:void(0)" onclick="switchMode()" class="switch__input" type="checkbox"
              role="switch">
            <svg class="switch__icon switch__icon--light" viewBox="0 0 12 12" width="12px" height="12px"
              aria-hidden="true">
              <g fill="none" stroke="#fff" stroke-width="1" stroke-linecap="round">
                <circle cx="6" cy="6" r="2" />
                <g stroke-dasharray="1.5 1.5">
                  <polyline points="6 10,6 11.5" transform="rotate(0,6,6)" />
                  <polyline points="6 10,6 11.5" transform="rotate(45,6,6)" />
                  <polyline points="6 10,6 11.5" transform="rotate(90,6,6)" />
                  <polyline points="6 10,6 11.5" transform="rotate(135,6,6)" />
                  <polyline points="6 10,6 11.5" transform="rotate(180,6,6)" />
                  <polyline points="6 10,6 11.5" transform="rotate(225,6,6)" />
                  <polyline points="6 10,6 11.5" transform="rotate(270,6,6)" />
                  <polyline points="6 10,6 11.5" transform="rotate(315,6,6)" />
                </g>
              </g>
            </svg>
            <svg class="switch__icon switch__icon--dark" viewBox="0 0 12 12" width="12px" height="12px"
              aria-hidden="true">
              <g fill="none" stroke="#fff" stroke-width="1" stroke-linejoin="round" transform="rotate(-45,6,6)">
                <path
                  d="m9,10c-2.209,0-4-1.791-4-4s1.791-4,4-4c.304,0,.598.041.883.105-.995-.992-2.367-1.605-3.883-1.605C2.962.5.5,2.962.5,6s2.462,5.5,5.5,5.5c1.516,0,2.888-.613,3.883-1.605-.285.064-.578.105-.883.105Z" />
              </g>
            </svg>
            <span class="switch__sr">Dark Mode</span>
          </label>
        </a>

        <a href="javascript:void(0)" id="avatar">
          <div class="container-avatar">
            <img src="./assets/images/avatar/avatar-1.png" alt="Avatar" />
          </div>
        </a>

        <!-- AVATAR DORPDOWN -->
        <div class="avatar-dropdown" id="avatarDropdown">
          <a href="profile.html">
            <li><span class="far fa-user"></span> Profile</li>
          </a>
          <a href="javascript:void(0)" onclick="supportChatMode()">
            <li><span class="far fa-comment"></span> Support</li>
          </a>
          <a href="premium.html" target="_blank">
            <li><span class="far fa-star"></span> Upgrade Plan</li>
          </a>
          <hr />
          <li>
            <button class="logoutBtn">
              Log out
            </button>
          </li>
        </div>
      </ul>
    </nav>

    <!-- SUPPORT & CHAT MODE -->
    <div class="overlay-support-chat-mode" id="supportChatMode">
      <div class="support-chat-mode">
        <!-- CHAT HEADER -->
        <div class="support-chat-mode-header">
          <h4>
            Support
            <img
              src="https://firebasestorage.googleapis.com/v0/b/ptitmusic-57385.appspot.com/o/main_logo.png?alt=media&token=03cfebd8-8068-4fc8-8372-d9c1a3b0aeb5"
              alt="" title="PtitMusic Bot" />
          </h4>
          <a href="javascript:void(0)" onclick="supportChatMode()"><span class="far fa-close"></span></a>
        </div>
        <!-- CHAT BODY -->
        <div class="support-chat-mode-body">
          <div class="chat-date">Today, September 26, 2023</div>
          <div class="section-message-bot">
            <img
              src="https://firebasestorage.googleapis.com/v0/b/ptitmusic-57385.appspot.com/o/main_logo.png?alt=media&token=03cfebd8-8068-4fc8-8372-d9c1a3b0aeb5"
              alt="" />
            <p>Hello! How can I assist you today?</p>
          </div>
          <div class="section-message-user">
            <img src="./assets/images/avatar/avatar-1.png" alt="PtitMusic Bot" />
            <p>Hi</p>
            <p>How to download as musics ZIP ???</p>
          </div>
          <div class="section-message-bot">
            <img
              src="https://firebasestorage.googleapis.com/v0/b/ptitmusic-57385.appspot.com/o/main_logo.png?alt=media&token=03cfebd8-8068-4fc8-8372-d9c1a3b0aeb5"
              alt="PtitMusic Bot" />
            <p>
              You most first click on the 'DOWNLOAD' button to automatically
              download ZIP file after a few seconds. <br /><br />
              If you have a problem, are you ready to be responsive to you.
            </p>
          </div>
          <div class="section-message-user">
            <img src="./assets/images/avatar/avatar-1.png" alt="" />
            <p>Thank you very much for your problem.</p>
            <p>üôèüôèüôè</p>
          </div>
        </div>
        <!-- CHAT FOOTER -->
        <div class="support-chat-mode-footer">
          <form action="" method="post">
            <span class="far fa-paperclip" onclick=""></span>
            <textarea name="" id="" cols="30" rows="1" placeholder="Write a msssage..."
              aria-placeholder="Write a msssage..."></textarea>
            <span class="far fa-smile" onclick=""></span>
            <button type="submit" aria-label="Send">Send</button>
          </form>
        </div>
      </div>
    </div>

    <!-- MAIN -->
    <main>
      <!-- Section Slide Image -->

      <div class="image__slider">
        <div class="image__slider__container">
          <div class="image__slider__item">
            <img src="https://i.pinimg.com/564x/73/e1/f7/73e1f7faceca4bc5c0f8c11d6fd17b79.jpg" alt="" />
          </div>
          <div class="image__slider__item">
            <img src="https://i.pinimg.com/564x/12/69/e8/1269e846437ab7d765254f45645c80ae.jpg" alt="" />
          </div>
          <div class="image__slider__item">
            <img src="https://i.pinimg.com/564x/b0/d8/97/b0d897d3013ae11ad61859ac4628054b.jpg" alt="" />
          </div>
          <div class="image__slider__item">
            <img src="https://i.pinimg.com/564x/c1/ef/6b/c1ef6b80edd6f4a3e38f8d8dedb7fdbb.jpg" alt="" />
          </div>
        </div>

      </div>

      <!-- End Section Slider Image -->
      <!-- #SECTION: EXPLORE -->
      <section class="section-explore" id="explore">
        <!-- EXPLORE MENU -->
        <div class="section-explore-menu">
          <h2>Explore</h2>
          <!-- <a href="#" class="section-explore-menu-item-active">Explore</a> -->
        </div>

        <!-- EXPLORE SLIDER -->
        <div class="card-grid-slider"></div>
      </section>

      <!-- #SECTION: FEATURED CREATORS -->
      <section class="section-featured-creators" id="featured_creators">
        <div>
          <h2>Featured Creators</h2>
        </div>

        <!-- FEATURED CREATORS SLIDER -->
        <div class="card-grid-slider">
          <div class="card-group-grid"></div>
          <div class="card-group-grid"></div>
          <div class="card-group-grid"></div>
          <div class="card-group-grid"></div>
          <div class="card-group-grid"></div>
          <div class="card-group-grid"></div>
          <div class="card-group-grid"></div>
          <div class="card-group-grid"></div>
          <div class="card-group-grid"></div>
        </div>
      </section>

      <!-- #SECTION: TRENDING -->
      <section class="section-trending" id="trending">
        <div>
          <h2>Trending</h2>
          <p><a href="">See all</a></p>
        </div>

        <!-- TRENDING SLIDER -->
        <div class="card-grid-slider" id="treding_container">
          <!-- CARD GROUP GRID -->
          <div class="card-group-grid"></div>
          <div class="card-group-grid"></div>
          <div class="card-group-grid"></div>
          <div class="card-group-grid"></div>
          <div class="card-group-grid"></div>
        </div>
      </section>

      <!-- #SECTION: CATEGORY -->
      <section class="section-category" id="category">
        <div>
          <h2>Genre</h2>
        </div>

        <!-- CATEGORY SLIDER -->
        <div class="card-grid-slider">
          <!-- CARD GROUP GRID -->

          <div class="card-group-grid">
          </div>
          <div class="card-group-grid">
          </div>
          <div class="card-group-grid">
          </div>
          <div class="card-group-grid">
          </div>
          <div class="card-group-grid">
          </div>
          <div class="card-group-grid">
          </div>
          <div class="card-group-grid">
          </div>
          <div class="card-group-grid">
          </div>
        </div>
      </section>

      <!-- #SECTION: POPULAR ARTISTS -->
      <section class="section-popular-artists" id="popular_artists">
        <div>
          <h2>Famous Singer</h2>
        </div>

        <!-- POPULAR ARTISTS SLIDER -->
        <div class="card-grid-slider"></div>
      </section>
    </main>

    <!-- #SECTION: MUSIC PLAYER -->
    <section class="section-music-player" id="sectionMusicPlayer">
    </section>

    <!-- Chat Bot -->

    <!-- End Chat Bot -->
    <!-- BACK TOP -->
    <a href="#Top">
      <div class="back-top" id="backTop">
        <span class="far fa-angle-up"></span>
      </div>
    </a>
  </section>
  <!-- End Section Main -->

  <!-- Slick Js -->
  <script type="text/javascript" src="./assets/animation/slick/jquery-1.11.0.min.js"></script>
  <script type="text/javascript" src="./assets/animation/slick/jquery-migrate-1.2.1.min.js"></script>
  <script type="text/javascript" src="./assets/animation/slick/slick.min.js"></script>

  <!-- IMPORT JS -->
  <script src="./assets/js/app.js"></script>
  <script type="module" src="./assets/js/helpers/api_main_page.js"></script>

  <script>
    $('.image__slider__container').slick({
      arrows: true,
      centerMode: true,
      slidesToShow: 2,
      autoplay: true,
      autoplaySpeed: 5000,
      responsive: [
        {
          breakpoint: 768,
          settings: {
            arrows: true,
            centerMode: true,
            slidesToShow: 1
          }
        },
      ]
    });
  </script>

  <script>
    function playCurrentSong() {
      // L·∫•y d·ªØ li·ªáu b√†i h√°t t·ª´ localStorage
      const currentSongString = localStorage.getItem("currentSong");

      // L·∫•y th·ªùi gian hi·ªán t·∫°i c·ªßa b√†i h√°t t·ª´ localStorage
      const currentTime =
        parseFloat(localStorage.getItem("currentSongTime")) || 0;

      // Ki·ªÉm tra xem d·ªØ li·ªáu c√≥ t·ªìn t·∫°i kh√¥ng
      if (currentSongString) {
        // L·∫•y ph·∫ßn t·ª≠ ch·ª©a music player t·ª´ DOM
        const musicPlayer = document.getElementById("sectionMusicPlayer");

        // Chuy·ªÉn ƒë·ªïi chu·ªói JSON th√†nh ƒë·ªëi t∆∞·ª£ng JavaScript
        const currentSong = JSON.parse(currentSongString);
        musicPlayer.style.cssText = `
          background-image: url(${currentSong.imagecover});
          background-size: cover;
          background-repeat: no-repeat;
          background-position: center;
        `;

        // T·∫°o HTML cho music player d·ª±a tr√™n th√¥ng tin c·ªßa b√†i h√°t
        const html = `
        <div class="containerPlayer">
          <div>
            <span class="far fa-angle-down" id="collapseMusicPlayerBtn" onclick="collapseMusicPlayer()"></span>
            <span class="far fa-angle-up" id="expandMusicPlayerBtn" onclick="collapseMusicPlayer()"></span>
            <div class="item__image">
              <img src="${currentSong.imagecover}" alt="${currentSong.title}" />
            </div>
            </div>
          <div class="item__infor">
            <h4>${currentSong.title}</h4>
            <a href="${currentSong.artistLink}">${currentSong.artist}</a>
          </div>
          <div class="section-music-player-timeline">
            <audio src="${currentSong.link}" autoplay controls></audio>
          </div>
        </div>
        `;

        // G√°n n·ªôi dung HTML v√†o ph·∫ßn t·ª≠ music player
        musicPlayer.innerHTML = html;

        // ƒê·∫∑t th·ªùi gian hi·ªán t·∫°i c·ªßa b√†i h√°t trong player
        const audioElement = musicPlayer.querySelector("audio");
        audioElement.addEventListener("ended", (e) => {
          // ƒê·∫∑t th·ªùi gian hi·ªán t·∫°i c·ªßa b√†i h√°t v·ªÅ 0
          audioElement.currentTime = 0;

          // Ph√°t l·∫°i nh·∫°c t·ª´ ƒë·∫ßu
          audioElement.play();
        });

        audioElement.addEventListener("input", (e) => {
          // L·∫•y gi√° tr·ªã c·ªßa thanh tua (v·ªã tr√≠ tua hi·ªán t·∫°i)
          const seekTime = parseFloat(e.target.value);

          // ƒê·∫∑t th·ªùi gian hi·ªán t·∫°i c·ªßa b√†i h√°t t∆∞∆°ng ·ª©ng v·ªõi v·ªã tr√≠ tua m·ªõi
          audioElement.currentTime = seekTime;
        });
        audioElement.currentTime = currentTime;
        audioElement.autoplay = true;
      } else {
        // L·∫•y ra b√†i h√°t ƒë·∫ßu ti√™n trong danh s√°ch b√†i h√°t n·∫øu kh√¥ng c√≥ b√†i h√°t n√†o ƒëang ph√°t
        const idxRamdom = Math.floor(Math.random() * songs.length);
        const currentSong = songs[idxRamdom];
        const musicPlayer = document.getElementById("sectionMusicPlayer");
        musicPlayer.style.cssText = `
          background-image: url(${currentSong.imagecover});
          background-size: cover;
          background-repeat: no-repeat;
          background-position: center;
        `;
        const html = `
        <div class="containerPlayer">
          <div>
            <span class="far fa-angle-down" id="collapseMusicPlayerBtn" onclick="collapseMusicPlayer()"></span>
            <span class="far fa-angle-up" id="expandMusicPlayerBtn" onclick="collapseMusicPlayer()"></span>
            <div class="item__image">
              <img src="${currentSong.imagecover}" alt="${currentSong.title}" />
            </div>
            </div>
          <div class="item__infor">
            <h4>${currentSong.title}</h4>
            <a href="${currentSong.artistLink}">${currentSong.artist}</a>
          </div>
          <div class="section-music-player-timeline">
            <audio src="${currentSong.link}" autoplay controls></audio>
          </div>
        </div>
        `;
        musicPlayer.innerHTML = html;
        const audioElement = musicPlayer.querySelector("audio");
        audioElement.addEventListener("ended", (e) => {
          audioElement.currentTime = 0;
          audioElement.play();
        });
        audioElement.addEventListener("input", (e) => {
          const seekTime = parseFloat(e.target.value);
          audioElement.currentTime = seekTime;
        });
        audioElement.currentTime = currentTime;
        audioElement.autoplay = true;

      }
    }
    playCurrentSong();
  </script>

  <script>
    // Ki·ªÉm tra xem c√≥ cookie ch·ª©a token hay kh√¥ng
    function getCookie(name) {
      const cookieValue = document.cookie.match('(^|;)\\s*' + name + '\\s*=\\s*([^;]+)');
      return cookieValue ? cookieValue.pop() : '';
    }
    
    // L·∫•y gi√° tr·ªã c·ªßa cookie 'accessToken'
    const accessToken = getCookie('accessToken');
    console.log(accessToken);

    // N·∫øu kh√¥ng c√≥ token, chuy·ªÉn h∆∞·ªõng ng∆∞·ªùi d√πng ƒë·∫øn trang ƒëƒÉng nh·∫≠p
    if (!accessToken) {
      window.location.href = '/login.html';
    }

    // L·∫•y ph·∫ßn t·ª≠ n√∫t logout t·ª´ DOM
    const logoutButton = document.querySelector('.logoutBtn');

    // L·∫Øng nghe s·ª± ki·ªán click tr√™n n√∫t logout
    logoutButton.addEventListener('click', function () {
      if (hasAccessTokenCookie()) {
        // X√≥a cookie ch·ª©a token
        deleteCookie('accessToken');

        // Chuy·ªÉn h∆∞·ªõng ng∆∞·ªùi d√πng ƒë·∫øn trang ƒëƒÉng nh·∫≠p
        window.location.href = '/login.html';
      } else {
        // N·∫øu kh√¥ng c√≥ cookie, chuy·ªÉn h∆∞·ªõng ng∆∞·ªùi d√πng ƒë·∫øn trang ƒëƒÉng nh·∫≠p
        window.location.href = '/login.html';
      }
    });

    // H√†m x√≥a cookie
    function deleteCookie(name) {
      document.cookie = name + '=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';
    }


  </script>
</body>

</html>